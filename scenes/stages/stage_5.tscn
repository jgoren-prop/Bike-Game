[gd_scene load_steps=28 format=3]

[ext_resource type="Script" path="res://scripts/systems/stage_base.gd" id="1_stage_base"]
[ext_resource type="Script" path="res://scripts/systems/moving_platform.gd" id="2_moving"]
[ext_resource type="Script" path="res://scripts/systems/pusher_block.gd" id="3_pusher"]

[sub_resource type="BoxShape3D" id="BoxShape3D_wide"]
size = Vector3(14, 1, 30)

[sub_resource type="BoxMesh" id="BoxMesh_wide"]
size = Vector3(14, 1, 30)

[sub_resource type="BoxShape3D" id="BoxShape3D_medium"]
size = Vector3(10, 1, 20)

[sub_resource type="BoxMesh" id="BoxMesh_medium"]
size = Vector3(10, 1, 20)

[sub_resource type="BoxShape3D" id="BoxShape3D_narrow"]
size = Vector3(5, 1, 15)

[sub_resource type="BoxMesh" id="BoxMesh_narrow"]
size = Vector3(5, 1, 15)

[sub_resource type="BoxShape3D" id="BoxShape3D_moving"]
size = Vector3(7, 1, 10)

[sub_resource type="BoxMesh" id="BoxMesh_moving"]
size = Vector3(7, 1, 10)

[sub_resource type="BoxShape3D" id="BoxShape3D_small"]
size = Vector3(5, 1, 6)

[sub_resource type="BoxMesh" id="BoxMesh_small"]
size = Vector3(5, 1, 6)

[sub_resource type="BoxShape3D" id="BoxShape3D_ramp"]
size = Vector3(12, 0.6, 16)

[sub_resource type="BoxMesh" id="BoxMesh_ramp"]
size = Vector3(12, 0.6, 16)

[sub_resource type="BoxShape3D" id="BoxShape3D_pusher"]
size = Vector3(3, 3, 3)

[sub_resource type="BoxMesh" id="BoxMesh_pusher"]
size = Vector3(3, 3, 3)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_road"]
albedo_color = Color(0.2, 0.22, 0.28, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_moving"]
albedo_color = Color(0.4, 0.2, 0.6, 1)
emission_enabled = true
emission = Color(0.15, 0.05, 0.25, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_ramp"]
albedo_color = Color(0.5, 0.4, 0.3, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_danger"]
albedo_color = Color(0.7, 0.15, 0.15, 1)
emission_enabled = true
emission = Color(0.3, 0.05, 0.05, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_pusher"]
albedo_color = Color(0.9, 0.3, 0.1, 1)
emission_enabled = true
emission = Color(0.4, 0.1, 0.02, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_edge"]
albedo_color = Color(0.8, 0.2, 0.8, 1)
emission_enabled = true
emission = Color(0.3, 0.05, 0.3, 1)

[sub_resource type="BoxMesh" id="BoxMesh_edge"]
size = Vector3(0.4, 0.25, 30)

[sub_resource type="BoxShape3D" id="BoxShape3D_gate"]
size = Vector3(12, 5, 1)

[sub_resource type="BoxMesh" id="BoxMesh_finish"]
size = Vector3(14, 5, 0.5)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_finish"]
albedo_color = Color(1, 0.9, 0.5, 1)
emission_enabled = true
emission = Color(0.5, 0.4, 0.1, 1)

[sub_resource type="BoxShape3D" id="BoxShape3D_fall"]
size = Vector3(800, 1, 800)

[node name="Stage5" type="Node3D"]
script = ExtResource("1_stage_base")
stage_number = 5
time_limit = 150.0

[node name="SpawnPoint" type="Marker3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.5, 12)

[node name="StartGate" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3, 12)

[node name="CollisionShape3D" type="CollisionShape3D" parent="StartGate"]
shape = SubResource("BoxShape3D_gate")

[node name="Section1_Start" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 22)

[node name="Collision" type="CollisionShape3D" parent="Section1_Start"]
shape = SubResource("BoxShape3D_wide")

[node name="Mesh" type="MeshInstance3D" parent="Section1_Start"]
mesh = SubResource("BoxMesh_wide")
surface_material_override/0 = SubResource("StandardMaterial3D_road")

[node name="EdgeL" type="MeshInstance3D" parent="Section1_Start"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6.8, 0.62, 0)
mesh = SubResource("BoxMesh_edge")
surface_material_override/0 = SubResource("StandardMaterial3D_edge")

[node name="EdgeR" type="MeshInstance3D" parent="Section1_Start"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.8, 0.62, 0)
mesh = SubResource("BoxMesh_edge")
surface_material_override/0 = SubResource("StandardMaterial3D_edge")

[node name="Ramp1_Up" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.94, 0.342, 0, -0.342, 0.94, 0, 3.5, 52)

[node name="Collision" type="CollisionShape3D" parent="Ramp1_Up"]
shape = SubResource("BoxShape3D_ramp")

[node name="Mesh" type="MeshInstance3D" parent="Ramp1_Up"]
mesh = SubResource("BoxMesh_ramp")
surface_material_override/0 = SubResource("StandardMaterial3D_ramp")

[node name="Section2_High" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 9, 80)

[node name="Collision" type="CollisionShape3D" parent="Section2_High"]
shape = SubResource("BoxShape3D_medium")

[node name="Mesh" type="MeshInstance3D" parent="Section2_High"]
mesh = SubResource("BoxMesh_medium")
surface_material_override/0 = SubResource("StandardMaterial3D_road")

[node name="MovingPlatform1" type="AnimatableBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 9, 110)
script = ExtResource("2_moving")
move_distance = Vector3(20, 0, 0)
move_duration = 2.5

[node name="Collision" type="CollisionShape3D" parent="MovingPlatform1"]
shape = SubResource("BoxShape3D_moving")

[node name="Mesh" type="MeshInstance3D" parent="MovingPlatform1"]
mesh = SubResource("BoxMesh_moving")
surface_material_override/0 = SubResource("StandardMaterial3D_moving")

[node name="Section3_Gauntlet" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 9, 140)

[node name="Collision" type="CollisionShape3D" parent="Section3_Gauntlet"]
shape = SubResource("BoxShape3D_medium")

[node name="Mesh" type="MeshInstance3D" parent="Section3_Gauntlet"]
mesh = SubResource("BoxMesh_medium")
surface_material_override/0 = SubResource("StandardMaterial3D_danger")

[node name="Pusher1" type="AnimatableBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 11, 135)
script = ExtResource("3_pusher")
push_distance = Vector3(12, 0, 0)
push_duration = 0.35
wait_time = 2.0

[node name="Collision" type="CollisionShape3D" parent="Pusher1"]
shape = SubResource("BoxShape3D_pusher")

[node name="Mesh" type="MeshInstance3D" parent="Pusher1"]
mesh = SubResource("BoxMesh_pusher")
surface_material_override/0 = SubResource("StandardMaterial3D_pusher")

[node name="Pusher2" type="AnimatableBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10, 11, 145)
script = ExtResource("3_pusher")
push_distance = Vector3(-12, 0, 0)
push_duration = 0.35
wait_time = 1.8

[node name="Collision" type="CollisionShape3D" parent="Pusher2"]
shape = SubResource("BoxShape3D_pusher")

[node name="Mesh" type="MeshInstance3D" parent="Pusher2"]
mesh = SubResource("BoxMesh_pusher")
surface_material_override/0 = SubResource("StandardMaterial3D_pusher")

[node name="Ramp2_Down" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.906, -0.423, 0, 0.423, 0.906, 0, 5, 165)

[node name="Collision" type="CollisionShape3D" parent="Ramp2_Down"]
shape = SubResource("BoxShape3D_ramp")

[node name="Mesh" type="MeshInstance3D" parent="Ramp2_Down"]
mesh = SubResource("BoxMesh_ramp")
surface_material_override/0 = SubResource("StandardMaterial3D_ramp")

[node name="Section4_Low" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 195)

[node name="Collision" type="CollisionShape3D" parent="Section4_Low"]
shape = SubResource("BoxShape3D_medium")

[node name="Mesh" type="MeshInstance3D" parent="Section4_Low"]
mesh = SubResource("BoxMesh_medium")
surface_material_override/0 = SubResource("StandardMaterial3D_road")

[node name="NarrowPath1" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 225)

[node name="Collision" type="CollisionShape3D" parent="NarrowPath1"]
shape = SubResource("BoxShape3D_narrow")

[node name="Mesh" type="MeshInstance3D" parent="NarrowPath1"]
mesh = SubResource("BoxMesh_narrow")
surface_material_override/0 = SubResource("StandardMaterial3D_danger")

[node name="MovingPlatform2_Vertical" type="AnimatableBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -3, 250)
script = ExtResource("2_moving")
move_distance = Vector3(0, 8, 0)
move_duration = 2.0

[node name="Collision" type="CollisionShape3D" parent="MovingPlatform2_Vertical"]
shape = SubResource("BoxShape3D_moving")

[node name="Mesh" type="MeshInstance3D" parent="MovingPlatform2_Vertical"]
mesh = SubResource("BoxMesh_moving")
surface_material_override/0 = SubResource("StandardMaterial3D_moving")

[node name="Section5_HighAgain" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 5, 280)

[node name="Collision" type="CollisionShape3D" parent="Section5_HighAgain"]
shape = SubResource("BoxShape3D_medium")

[node name="Mesh" type="MeshInstance3D" parent="Section5_HighAgain"]
mesh = SubResource("BoxMesh_medium")
surface_material_override/0 = SubResource("StandardMaterial3D_road")

[node name="MovingPlatform3" type="AnimatableBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 5, 305)
script = ExtResource("2_moving")
move_distance = Vector3(-16, 0, 0)
move_duration = 2.0

[node name="Collision" type="CollisionShape3D" parent="MovingPlatform3"]
shape = SubResource("BoxShape3D_small")

[node name="Mesh" type="MeshInstance3D" parent="MovingPlatform3"]
mesh = SubResource("BoxMesh_small")
surface_material_override/0 = SubResource("StandardMaterial3D_moving")

[node name="MovingPlatform4" type="AnimatableBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8, 5, 320)
script = ExtResource("2_moving")
move_distance = Vector3(16, 0, 0)
move_duration = 2.0
pause_duration = 0.3

[node name="Collision" type="CollisionShape3D" parent="MovingPlatform4"]
shape = SubResource("BoxShape3D_small")

[node name="Mesh" type="MeshInstance3D" parent="MovingPlatform4"]
mesh = SubResource("BoxMesh_small")
surface_material_override/0 = SubResource("StandardMaterial3D_moving")

[node name="Section6_PreFinal" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 5, 345)

[node name="Collision" type="CollisionShape3D" parent="Section6_PreFinal"]
shape = SubResource("BoxShape3D_medium")

[node name="Mesh" type="MeshInstance3D" parent="Section6_PreFinal"]
mesh = SubResource("BoxMesh_medium")
surface_material_override/0 = SubResource("StandardMaterial3D_danger")

[node name="Pusher3_Final" type="AnimatableBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 7, 350)
script = ExtResource("3_pusher")
push_distance = Vector3(14, 0, 0)
push_duration = 0.25
wait_time = 1.2

[node name="Collision" type="CollisionShape3D" parent="Pusher3_Final"]
shape = SubResource("BoxShape3D_pusher")

[node name="Mesh" type="MeshInstance3D" parent="Pusher3_Final"]
mesh = SubResource("BoxMesh_pusher")
surface_material_override/0 = SubResource("StandardMaterial3D_pusher")

[node name="Section7_Victory" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 5, 380)

[node name="Collision" type="CollisionShape3D" parent="Section7_Victory"]
shape = SubResource("BoxShape3D_wide")

[node name="Mesh" type="MeshInstance3D" parent="Section7_Victory"]
mesh = SubResource("BoxMesh_wide")
surface_material_override/0 = SubResource("StandardMaterial3D_road")

[node name="EdgeL" type="MeshInstance3D" parent="Section7_Victory"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6.8, 0.62, 0)
mesh = SubResource("BoxMesh_edge")
surface_material_override/0 = SubResource("StandardMaterial3D_edge")

[node name="EdgeR" type="MeshInstance3D" parent="Section7_Victory"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.8, 0.62, 0)
mesh = SubResource("BoxMesh_edge")
surface_material_override/0 = SubResource("StandardMaterial3D_edge")

[node name="FinishGate" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 8, 393)

[node name="CollisionShape3D" type="CollisionShape3D" parent="FinishGate"]
shape = SubResource("BoxShape3D_gate")

[node name="FinishVisual" type="MeshInstance3D" parent="FinishGate"]
mesh = SubResource("BoxMesh_finish")
surface_material_override/0 = SubResource("StandardMaterial3D_finish")

[node name="FallPlane" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -50, 200)

[node name="CollisionShape3D" type="CollisionShape3D" parent="FallPlane"]
shape = SubResource("BoxShape3D_fall")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.866, -0.354, 0.354, 0, 0.707, 0.707, -0.5, -0.612, 0.612, 0, 50, 0)
light_energy = 1.4
shadow_enabled = true
